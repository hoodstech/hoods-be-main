# Быстрый старт

[English version](./QUICKSTART.md)

Настройте среду разработки за 5 минут!

## Требования

- Node.js 18+ установлен
- Docker Desktop установлен (для простой настройки БД)
- Учетные данные Google OAuth (опционально для тестирования)

## Шаг 1: Установка зависимостей

```bash
npm install
```

## Шаг 2: Настройка окружения

Скопируйте файл окружения для разработки:

```bash
cp .env.development .env
```

Если хотите протестировать Google OAuth, обновите файл [.env](.env.development) с вашими учетными данными Google. Иначе можете пропустить этот шаг и тестировать другие эндпоинты.

## Шаг 3: Запуск базы данных

Используя Docker (проще всего):

```bash
npm run docker:dev
```

Это запустит PostgreSQL в контейнере с учетными данными по умолчанию.

## Шаг 4: Запуск миграций

Сгенерируйте и примените миграции базы данных:

```bash
npm run db:generate
npm run db:migrate
```

## Шаг 5: Запуск сервера разработки

```bash
npm run dev
```

Ваш сервер теперь работает на `http://localhost:3000`

## Проверка настройки

### Проверка здоровья

```bash
curl http://localhost:3000/health
```

Ожидаемый ответ:
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### Регистрация пользователя

```bash
curl -X POST http://localhost:3000/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","name":"Тестовый пользователь"}'
```

Ожидаемый ответ:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "email": "test@example.com",
    "name": "Тестовый пользователь"
  }
}
```

### Google OAuth

Откройте в браузере:
```
http://localhost:3000/auth/google
```

Это перенаправит вас на страницу согласия Google OAuth (если учетные данные настроены).

## Следующие шаги

- Прочитайте [README.ru.md](./README.ru.md) для полной документации
- Посмотрите [ARCHITECTURE.ru.md](./ARCHITECTURE.ru.md) чтобы понять структуру проекта
- Изучите директорию [src/](./src/) чтобы увидеть организацию кода

## Частые проблемы

### Порт уже используется

Если порт 3000 уже используется, измените `PORT` в вашем файле `.env`:

```env
PORT=3001
```

### Ошибка подключения к базе данных

Убедитесь, что Docker запущен и контейнер PostgreSQL работает:

```bash
docker ps
```

Вы должны увидеть `hoods-postgres-dev` в списке.

Чтобы перезапустить базу данных:

```bash
npm run docker:dev:down
npm run docker:dev
```

### Ошибки миграций

Если миграции не работают, убедитесь что база данных запущена и доступна. Можете проверить подключение запустив:

```bash
docker exec -it hoods-postgres-dev psql -U postgres -d hoods_db
```

## Рабочий процесс разработки

1. Вносите изменения в код
2. Сервер автоматически перезагружается (благодаря `tsx watch`)
3. Тестируйте изменения
4. Коммитьте код

### Добавление новой таблицы в БД

1. Создайте схему в `src/db/schemas/`
2. Сгенерируйте миграцию: `npm run db:generate`
3. Примените миграцию: `npm run db:migrate`
4. Создайте репозиторий, сервис и маршруты по необходимости

### Просмотр базы данных

Используйте Drizzle Studio для визуального просмотра базы данных:

```bash
npm run db:studio
```

Это откроет веб-интерфейс на `https://local.drizzle.studio`

## Полезные команды

```bash
# Разработка
npm run dev              # Запуск dev сервера
npm run lint            # Проверка стиля кода
npm run lint:fix        # Исправление проблем со стилем

# База данных
npm run db:generate     # Генерация файлов миграций
npm run db:migrate      # Запуск миграций
npm run db:studio       # Открыть GUI базы данных

# Docker
npm run docker:dev      # Запустить PostgreSQL
npm run docker:dev:down # Остановить PostgreSQL
```

## Получение помощи

- Проверьте [README.ru.md](./README.ru.md) для детальной документации
- Просмотрите [ARCHITECTURE.ru.md](./ARCHITECTURE.ru.md) для архитектурных паттернов
- Посмотрите на существующий код в [src/](./src/) для примеров

Приятной разработки!
